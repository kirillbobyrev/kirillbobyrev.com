<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>TIL: Latexify translates Python into LaTeX</title><meta name=author content="Kirill Bobyrev"><meta name=description content="Kirill Bobyrev's blog about software engineering and my hobbies"><meta name=keywords content="blog,programming,computer-science,developer,personal,startups"><link rel=apple-touch-icon sizes=180x180 href=/icons/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/icons/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/icons/favicon-16x16.png><link rel=manifest href=/icons/site.webmanifest><script async src="https://www.googletagmanager.com/gtag/js?id=G-RHCZGDQQJR"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-RHCZGDQQJR",{anonymize_ip:!1})}</script><meta name=twitter:card content="summary"><meta name=twitter:title content="TIL: Latexify translates Python into LaTeX"><meta name=twitter:description content="Today I learned about latexify, a small Python package that helps translate Python functions code into LaTeX. At first glance, one might use it for:
Making Jupyter notebooks more readable by folding the code and showing LaTeX-rendered definitions of the functions and integrating them into the textual. Using the LaTeX output to generate parts of scientific papers, thesis or any human-readable text. Let&rsquo;s see what it can do!
Using latexify Using latexify is easy: choose a function you would like to render in LaTeX and use @latexify."><meta property="og:title" content="TIL: Latexify translates Python into LaTeX"><meta property="og:description" content="Today I learned about latexify, a small Python package that helps translate Python functions code into LaTeX. At first glance, one might use it for:
Making Jupyter notebooks more readable by folding the code and showing LaTeX-rendered definitions of the functions and integrating them into the textual. Using the LaTeX output to generate parts of scientific papers, thesis or any human-readable text. Let&rsquo;s see what it can do!
Using latexify Using latexify is easy: choose a function you would like to render in LaTeX and use @latexify."><meta property="og:type" content="article"><meta property="og:url" content="https://kirillbobyrev.com/latexify/"><meta property="article:section" content><meta property="article:published_time" content="2022-11-16T00:00:00+00:00"><meta property="article:modified_time" content="2022-11-16T00:00:00+00:00"><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto|Roboto+Mono|Material+Symbols+Rounded"><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css integrity=sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js integrity=sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous onload=renderMathInElement(document.body)></script>
<script src=https://kit.fontawesome.com/bc841c7fb3.js crossorigin=anonymous></script></head><body><header><div class=center><h1><a href=/>Kirill Bobyrev</a></h1></div></header><main role=main><article><h1>TIL: Latexify translates Python into LaTeX</h1><span class=material-symbols-rounded>event</span>
&nbsp;
<time datetime='Nov 16, 2022'>Nov 16, 2022</time><br><span class=material-symbols-rounded>timer</span>
&nbsp;
<span class=monospaced>3 min to read</span><p>Today I learned about <a href=https://github.com/google/latexify_py>latexify</a>, a small
Python package that helps translate Python functions code into LaTeX. At first
glance, one might use it for:</p><ul><li>Making Jupyter notebooks more readable by folding the code and showing
LaTeX-rendered definitions of the functions and integrating them into the
textual.</li><li>Using the LaTeX output to generate parts of scientific papers, thesis or any
human-readable text.</li></ul><p>Let&rsquo;s see what it can do!</p><h2 id=using-latexify>Using <code>latexify</code></h2><p>Using <code>latexify</code> is easy: choose a function you would like to render in LaTeX
and use <code>@latexify.latexify</code> Python
<a href=https://docs.python.org/3/glossary.html#term-decorator>decorator</a>:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#000;font-weight:700>import</span> <span style=color:#555>latexify</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>import</span> <span style=color:#555>math</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#3c5d5d;font-weight:700>@latexify</span><span style=color:#000;font-weight:700>.</span>function
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>def</span> <span style=color:#900;font-weight:700>foo</span>(x):
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>if</span> x <span style=color:#000;font-weight:700>&lt;</span> <span style=color:#099>0</span>:
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>return</span> math<span style=color:#000;font-weight:700>.</span>floor(x <span style=color:#000;font-weight:700>-</span> <span style=color:#099>5</span>)
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>elif</span> <span style=color:#099>0</span> <span style=color:#000;font-weight:700>&lt;=</span> x <span style=color:#000;font-weight:700>and</span> x <span style=color:#000;font-weight:700>&lt;</span> <span style=color:#099>3</span>:
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>return</span> <span style=color:#099>2</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>else</span>:
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>return</span> math<span style=color:#000;font-weight:700>.</span>sin(x) <span style=color:#000;font-weight:700>/</span> x
</span></span></code></pre></td></tr></table></div></div><p>If you use it in Jupyter notebook and place <code>foo</code> at the end, the code block
will render this:</p><p>$$
\mathrm{foo}(x) =
\begin{cases}
\left\lfloor{x - {5}}\right\rfloor, & \mathrm{if} \ {x &lt; {0}} \newline
{2}, & \mathrm{if} \ {{{0} \le x} \land {x &lt; {3}}} \newline
\frac{\sin{\left({x}\right)}}{x}, & \mathrm{otherwise} \newline
\end{cases}
$$</p><p><code>latexify</code> uses heuristics to transform commonly used functions like
<code>math.floor</code> or <code>math.sin</code> into <code>\lfloor ... \rfloor</code> and <code>\sin{...}</code>
respectively. Under the hood <code>latexify</code> uses Python&rsquo;s <a href=https://docs.python.org/3/library/ast.html>Abstract Syntax Tree
library</a>. The core of <code>latexify</code>
library is the Abstract Syntax Tree visitor, which is a common pattern in
program analysis. The library code is rather straightforward and easy to
understand, supplemented by well-written documentation, so it&rsquo;s not hard to
understand how it works if you&rsquo;re familiar with Python.</p><p>If you&rsquo;re in the terminal, something like this will be the printed out as LaTeX
render of the <code>foo</code> function.</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-latex data-lang=latex><span style=display:flex><span><span style=color:#000;font-weight:700>\mathrm</span><span style=color:#0086b3>{</span>foo<span style=color:#0086b3>}</span>(x) = <span style=color:#000;font-weight:700>\left\{</span> <span style=color:#000;font-weight:700>\begin</span><span style=color:#0086b3>{</span>array<span style=color:#0086b3>}{</span>ll<span style=color:#0086b3>}</span> <span style=color:#000;font-weight:700>\left\lfloor</span><span style=color:#0086b3>{</span>x - <span style=color:#0086b3>{</span>5<span style=color:#0086b3>}}</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>\right</span> <span style=color:#000;font-weight:700>\rfloor</span>,<span style=color:#0086b3>&amp;</span> <span style=color:#000;font-weight:700>\mathrm</span><span style=color:#0086b3>{</span>if<span style=color:#0086b3>}</span> <span style=color:#000;font-weight:700>\ </span><span style=color:#0086b3>{</span>x &lt; <span style=color:#0086b3>{</span>0<span style=color:#0086b3>}}</span> <span style=color:#000;font-weight:700>\\</span> <span style=color:#0086b3>{</span>2<span style=color:#0086b3>}</span>, <span style=color:#0086b3>&amp;</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>\mathrm</span><span style=color:#0086b3>{</span>if<span style=color:#0086b3>}</span> <span style=color:#000;font-weight:700>\ </span><span style=color:#0086b3>{{{</span>0<span style=color:#0086b3>}</span> <span style=color:#000;font-weight:700>\le</span> x<span style=color:#0086b3>}</span> <span style=color:#000;font-weight:700>\land</span> <span style=color:#0086b3>{</span>x &lt; <span style=color:#0086b3>{</span>3<span style=color:#0086b3>}}}</span> <span style=color:#000;font-weight:700>\\</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>\frac</span><span style=color:#0086b3>{</span><span style=color:#000;font-weight:700>\sin</span><span style=color:#0086b3>{</span><span style=color:#000;font-weight:700>\left</span>(<span style=color:#0086b3>{</span>x<span style=color:#0086b3>}</span><span style=color:#000;font-weight:700>\right</span>)<span style=color:#0086b3>}}{</span>x<span style=color:#0086b3>}</span>,
</span></span><span style=display:flex><span>  <span style=color:#0086b3>&amp;</span> <span style=color:#000;font-weight:700>\mathrm</span><span style=color:#0086b3>{</span>otherwise<span style=color:#0086b3>}</span> <span style=color:#000;font-weight:700>\end</span><span style=color:#0086b3>{</span>array<span style=color:#0086b3>}</span> <span style=color:#000;font-weight:700>\right</span>.
</span></span></code></pre></td></tr></table></div></div><p>Unfortunately, this isn&rsquo;t well formatted LaTeX code. It&rsquo;s hard to edit this code
manually (it also uses <code>array</code> instead of <code>cases</code> which is suspicious). The
other problem is that it renders with <a href=https://www.mathjax.org/>MathJax</a>, but I
had to change it so that <a href=https://katex.org/>KaTeX</a> could render it. While
MathJax is very popular, it&rsquo;s much slower than KaTeX. So that could be a problem
if you&rsquo;d like to insert the generated LaTeX code into your website which uses
KaTeX (like my blog does).</p><h2 id=conclusion>Conclusion</h2><p><code>latexify</code> is a fun library to play with and it&rsquo;s certainly useful when building
Jupyter notebooks, but given low readability of generated code it&rsquo;s probably not
very useful beyond that. It won&rsquo;t make it into the toolbox of libraries I use
every day, but it&rsquo;s still an interesting example of using Python AST library.</p></article></main><footer class="footer fixed-bottom"><div class="container center"><a href=https://github.com/kirillbobyrev/ title=GitHub aria-label=GitHub><div class="fab fa-github fa-2x fa-icon fa-fw" aria-hidden=true></div></a><a href=https://linkedin.com/in/kirillbobyrev/ title=LinkedIn aria-label=LinkedIn><div class="fab fa-linkedin fa-2x fa-icon fa-fw" aria-hidden=true></div></a><a href=https://twitter.com/kirillbobyrev/ title=Twitter aria-label=Twitter><div class="fab fa-twitter fa-2x fa-icon fa-fw" aria-hidden=true></div></a></div></footer></body></html>