{{ define "main" }}

<h1 class="notes-title">{{ .Title }}</h1>

{{ .Content }}

<!-- Tag filtering system -->
{{ $pages := .Pages.ByDate.Reverse }}
{{ $allTags := slice }}
{{ range $pages }}
  {{ range .Params.tags }}
    {{ $allTags = $allTags | append . }}
  {{ end }}
{{ end }}
{{ $uniqueTags := $allTags | uniq | sort }}

{{ if gt (len $uniqueTags) 0 }}
<div class="tag-container">
  <button class="tag-filter tag-filter-all active" data-tag="all">All</button>
  {{ range $uniqueTags }}
    <button class="tag-filter" data-tag="{{ . }}">{{ . }}</button>
  {{ end }}
</div>
{{ end }}

<div class="notes-feed">
  {{ range $index, $page := $pages }}
  <div id="note-{{ add $index 1 }}" class="note-card"
      {{ if $page.Params.tags }}
      data-tags="{{ delimit $page.Params.tags "," }}"
      {{ end }}>
    <div class="note-header">
      <div class="note-header-left">
        <span class="note-number">
          <a href="{{ $.Permalink }}#note-{{ add $index 1 }}">#{{ add $index 1 }}</a>
        </span>
        <h3 class="note-title">{{ .Title }}</h3>
      </div>
      {{ if not .Date.IsZero }}
      <span class="note-date">{{ .Date.Format "Jan 2, 2006" }}</span>
      {{ end }}
    </div>
    <div class="note-content">
      {{ .Content }}
    </div>

    {{ if .Params.tags }}
    <div class="note-tags">
      {{ range .Params.tags }}
        <a href="#" class="note-tag" data-tag="{{ . }}">{{ . }}</a>
      {{ end }}
    </div>
    {{ end }}

    {{ if and (not .Date.IsZero) (gt .Date.Unix 0) }}
    <div class="note-timestamp">
      <i class="far fa-clock note-icon"></i>
      <span>{{ .Date.Format "3:04 PM Â· Jan 2, 2006" }}</span>
    </div>
    {{ end }}
  </div>
  {{ end }}
</div>

{{ end }}
